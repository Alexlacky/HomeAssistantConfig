#################################################
# Package Country House Climate
#################################################

ch_climate_pack:

# Sensors
  sensor:
    - platform: min_max
      name: Country House Avg Temp - Kids Rooms
      type: median
      entity_ids:
        - sensor.a4c138c7ded2_temperature
        - sensor.a4c1380b3a85_temperature
    - platform: min_max
      name: Country House Avg Humidity - Kids Rooms
      type: median
      entity_ids:
        - sensor.a4c138c7ded2_humidity
        - sensor.a4c1380b3a85_humidity
    - platform: template
      sensors:
        ch_heater_living_room_status:
          value_template: "{{ (state_attr('climate.country_house_living_room', 'hvac_action') == 'heating') | abs }}"
        ch_heater_kids_rooms_status:
          value_template: "{{ (state_attr('climate.country_house_kids_rooms', 'hvac_action') == 'heating') | abs }}"

# Binary Sensors:
  binary_sensor:
    - platform: template
      sensors:
        ch_heater_living_room_status:
          device_class: heat
          value_template: "{{ state_attr('climate.country_house_living_room', 'hvac_action') == 'heating' }}"
          icon_template: >-
            {% if state_attr('climate.country_house_living_room', 'hvac_action') == 'heating' %}
              mdi:radiator
            {% else %}
              mdi:radiator-disabled
            {% endif %}
        ch_heater_kids_rooms_status:
          device_class: heat
          value_template: "{{ (state_attr('climate.country_house_kids_rooms', 'hvac_action') == 'heating') }}"
          icon_template: >-
            {% if state_attr('climate.country_house_kids_rooms', 'hvac_action') == 'heating' %}
              mdi:radiator
            {% else %}
              mdi:radiator-disabled
            {% endif %}

# Climate
  climate:
    - platform: generic_thermostat
      unique_id: 9b877559-21bf-424b-8edc-0e1efb8c5834
      name: Country House Living Room
      heater: switch.broadlink_smartplug_02_switch
      target_sensor: sensor.a4c138d358e9_temperature
      min_temp: 5
      max_temp: 30
      cold_tolerance: 2
      hot_tolerance: 0.5
      min_cycle_duration:
        minutes: 1
      away_temp: 10
      precision: 0.1
    - platform: generic_thermostat
      unique_id: 5c3bb751-1458-4b32-b86c-5ef3206ded5a
      name: Country House Kids Rooms
      heater: switch.broadlink_smartplug_01_switch
      target_sensor: sensor.country_house_avg_temp_kids_rooms
      min_temp: 5
      max_temp: 30
      cold_tolerance: 2
      hot_tolerance: 0.5
      min_cycle_duration:
        minutes: 1
      away_temp: 10
      precision: 0.1